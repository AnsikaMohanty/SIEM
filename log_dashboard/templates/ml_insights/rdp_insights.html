<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RDP ML Insights</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>
<body>
<nav class="navbar navbar-dark bg-dark shadow">
    <div class="container">
      <a href="/" class="navbar-brand">SIEM Dashboard</a>
      <a href="{{ url_for('logs.rdp_events') }}" class="btn btn-outline-light ms-auto">
        <i class="bi bi-arrow-left"></i> Back to Logs
      </a>
    </div>
  </nav>


<div class="container my-5">
<h2 class="mb-4 text-center">ðŸ“Š RDP ML Insights</h2>

<!-- Classification Results -->
<div class="card mb-4">
<div class="card-body">
<h5>Classification Results</h5>
<table class="table table-bordered">
<thead>
<tr><th>Model</th><th>Accuracy</th></tr>
</thead>
<tbody>
{% for model, acc in results.items() %}
<tr><td>{{ model }}</td><td>{{ "%.2f"|format(acc*100) }}%</td></tr>
{% endfor %}
</tbody>
</table>
</div>
</div>

<!-- User Behavior -->
<div class="card mb-4">
<div class="card-body">
<h5>User Behavior Profiling</h5>
<table class="table table-bordered table-hover">
<thead>
<tr>
<th>Username</th>
<th>Total Sessions</th>
<th>Unique IPs</th>
<th>Most Common Hour</th>
</tr>
</thead>
<tbody>
{% for user in user_stats.itertuples() %}
<tr>
<td>{{ user.username }}</td>
<td>{{ user.total_sessions }}</td>
<td>{{ user.unique_ips }}</td>
<td>{{ user.most_common_hour if user.most_common_hour is not none else 'N/A' }}</td>
</tr>
{% endfor %}
</tbody>
</table>
</div>
</div>

<!-- Plots -->
<div class="container mt-4">
<h4>Plots</h4>
<div class="row">
{% for img in images %}
<div class="col-md-6 mb-3">
<img src="{{ url_for('static', filename='rdp_outputs/' + img) }}" class="img-fluid border rounded shadow">
<p class="text-center">{{ img.replace('_', ' ').replace('.png','') }}</p>
</div>
{% endfor %}
</div>
</div>

</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
